(struct ($e)
    (prop! $e R:1:0
        (struct ($f)
            (prop! $f R:2:0
                (set (.. @a #u $b))
            )
        )
    )
    (prop! $e R:1:1
        (set (.. @c #u $d))
    )
)

// Note: The expr prop R:3:0 itself does not depend on anything in scope.
// So it's constant in this sense, but each _child_ need to _clone_ the original scope.
(struct ($g)
    (prop! $g R:3:0
        (struct ($h)
            (prop! $h R:4:0
                (struct ($i)
                    (prop! $i R:5:0
                        (set (.. @a #u $b))
                    )
                )
            )
            (prop! $h R:4:1
                (set (.. @c #u $d))
            )
        )
    )
)

|$e| (block
    (let-prop $f ($e R:1:0))
    (let-prop $a ($f R:2:0))
    (let-prop $c ($e R:1:1))
    (struct ($g)
        (prop! $g R:3:0
            (struct ($h)
                (prop! $h R:4:0
                    (struct ($i)
                        (prop! $i R:5:0
                            (make-seq ($j)
                                (for-each $a ($_ $b)
                                    (insert $j #u $b)
                                )
                            )
                        )
                    )
                )
                (prop! $h R:4:1
                    (make-seq ($k)
                        (for-each $c ($_ $d)
                            (insert $k #u $d)
                        )
                    )
                )
            )
        )
        (move-rest-attrs $g $e)
    )
)
