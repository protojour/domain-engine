(struct ($e)
    (prop! $e R:1:0
        (set
            (.. @f
                (struct ($g)
                    (prop! $g R:2:0 $a)
                    (prop! $g R:2:1 $b)
                )
                (struct ($h)
                    (prop! $h R:3:0 $c)
                    (prop! $h R:3:1 $d)
                )
            )
        )
    )
)

(struct ($i)
    (prop! $i R:4:0
        (set
            (.. @f
                (struct ($j)
                    (prop! $j R:5:0 $a)
                    (prop! $j R:5:1 $c)
                )
                (struct ($k)
                    (prop! $k R:6:0 $b)
                    (prop! $k R:6:1 $d)
                )
            )
        )
    )
)

|$e| (block
    (let-prop $f ($e R:1:0))
    (struct ($i)
        (prop! $i R:4:0
            (make-seq ($l)
                (for-each $f ($g $h)
                    (let-prop $a ($g R:2:0))
                    (let-prop $b ($g R:2:1))
                    (let-prop $c ($h R:3:0))
                    (let-prop $d ($h R:3:1))
                    (insert $l
                        (struct ($j)
                            (prop! $j R:5:0 $a)
                            (prop! $j R:5:1 $c)
                        )
                        (struct ($k)
                            (prop! $k R:6:0 $b)
                            (prop! $k R:6:1 $d)
                        )
                    )
                )
            )
        )
        (move-rest-attrs $i $e)
    )
)